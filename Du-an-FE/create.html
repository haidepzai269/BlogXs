<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>T·∫°o b√†i ƒëƒÉng m·ªõi</title>
  <link rel="stylesheet" href="home.css" />
  <link rel="stylesheet" href="create.css">
  <script src="https://unpkg.com/@phosphor-icons/web"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>

</head>
<body>
  <div class="container">
    <!-- Sidebar -->
    <nav class="sidebar">
      <button title="Trang ch·ªß" onclick="goToHome()"><i class="ph ph-house sidebar-icon"></i></button>
      <button title="T√¨m ki·∫øm" onclick="goToSearch()"><i class="ph ph-magnifying-glass sidebar-icon"></i></button>
      <button title="T·∫°o b√†i ƒëƒÉng"><i class="ph ph-plus sidebar-icon" style="color: #1da1f2;"></i></button>
      <button title="H·ªì s∆° c√° nh√¢n" onclick="goToProfile()"><i class="ph ph-user sidebar-icon"></i></button>
      <button title="ƒê√£ th√≠ch" onclick="goToLike()"><i class="ph ph-thumbs-up sidebar-icon"></i></button>
      <button title="Short Video" id="shortBtn"><i class="ph ph-film-strip sidebar-icon"></i></button>
      <div class="menu-bottom">
        <button title="Menu" id="menuToggle"><i class="ph ph-list sidebar-icon"></i></button>
        <div class="menu-popup" id="menuPopup">
          <!-- C√°c n√∫t s·∫Ω ƒë∆∞·ª£c JS th√™m v√†o -->
        </div>
      </div>
      <div class="logout-button">
        <button class="sidebar-icon" title="ƒêƒÉng xu·∫•t" onclick="logout()">‚èª</button>
      </div>
    </nav>

    <!-- Main Content -->
    <main class="content">
      <h1>T·∫°o b√†i ƒëƒÉng m·ªõi</h1>
      <form id="createPostForm" class="create-post-form">
        <textarea name="content" id="postContent" rows="6" placeholder="B·∫°n ƒëang nghƒ© g√¨?"></textarea>
        <button type="submit">ƒêƒÉng b√†i</button>
      </form>
      <p id="postMessage" class="status-message"></p>
    </main>
    <!-- QR Link Input -->
    <div class="qr-link-container">
      <input type="text" id="qrLinkInput" placeholder="üîó D√°n link ƒë·ªÉ t·∫°o QR" />
      <button id="generateQRBtn" title="T·∫°o m√£ QR">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.8">
          <path stroke-linecap="round" stroke-linejoin="round" d="M3 7h2l2-3h10l2 3h2a2 2 0 012 2v10a2 2 0 01-2 2H3a2 2 0 01-2-2V9a2 2 0 012-2z"/>
          <circle cx="12" cy="13" r="4"/>
        </svg>
      </button>
    </div>

<!-- QR Popup -->
    <div id="qrPopup" class="qr-popup">
      <div id="qrCodeContainer"></div>
      <button id="closeQRPopup">‚úñ</button>
     </div>

  </div>
  <div class="overlay" id="menuOverlay"></div>
  <div id="logoContainer"></div>
  <canvas id="fireworksCanvas"></canvas>  
  <script src="authFetch.js"></script>
  <script  src="create.js"></script>
  <script>
    const savedTheme = localStorage.getItem('theme') || 'dark';
    document.body?.setAttribute('data-theme', savedTheme);
  </script>
  <script>
    const logoContainer = document.getElementById('logoContainer');
    const canvas = document.getElementById('fireworksCanvas');
    const ctx = canvas.getContext('2d');
    
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
    
    const text = 'BlogXs';
    
    // ----- FIREWORKS -----
    const fireworks = [];
    
    function createFirework(x, y) {
      for (let i = 0; i < 40; i++) {
        fireworks.push({
          x, y,
          angle: Math.random() * 2 * Math.PI,
          speed: Math.random() * 5 + 2,
          radius: Math.random() * 3 + 2,
          alpha: 1,
          color: `hsl(${Math.random() * 360}, 100%, 70%)`
        });
      }
    }
    
    function updateFireworks() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      fireworks.forEach((f, i) => {
        f.x += Math.cos(f.angle) * f.speed;
        f.y += Math.sin(f.angle) * f.speed;
        f.alpha -= 0.01;
        if (f.alpha <= 0) fireworks.splice(i, 1);
        else {
          ctx.beginPath();
          ctx.arc(f.x, f.y, f.radius, 0, Math.PI * 2);
          ctx.fillStyle = f.color;
          ctx.globalAlpha = f.alpha;
          ctx.fill();
          ctx.globalAlpha = 1;
        }
      });
      requestAnimationFrame(updateFireworks);
    }
    updateFireworks();
    // ----------------------
    
    async function showLetters() {
      logoContainer.innerHTML = '';
    
      for (let i = 0; i < text.length; i++) {
        const span = document.createElement('span');
        span.textContent = text[i];
        span.classList.add('glow-letter');
        span.style.animationDelay = `${i * 0.2}s`;
        logoContainer.appendChild(span);
      }
    
      await new Promise(r => setTimeout(r, text.length * 200 + 800));
    
      // Hi·ªán ƒë·ªß ch·ªØ -> b·∫Øn ph√°o hoa t·∫°i v·ªã tr√≠ ch·ªØ
      const rect = logoContainer.getBoundingClientRect();
      const fireworkX = rect.left + rect.width / 2;
      const fireworkY = rect.top;
    
      createFirework(fireworkX, fireworkY);
    
      await new Promise(r => setTimeout(r, 1500));
      logoContainer.innerHTML = '';
    }
    
    setInterval(showLetters, 4500);
    showLetters();
    </script>    
</body>
</html>
